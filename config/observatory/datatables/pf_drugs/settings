nameSingle: drug
namePlural: drugs

primKey: drug_id

properties: 
- id: drug_id
  dataType: Text
- id: short_description
  dataType: Text
- id: description
  dataType: Text
- id: name
  dataType: Text
  
  
dataItemViews:              # Lists the custom views that should appear in the popup for an individual data table item
- type: Template                                       # Add a template based view
  name: Details
  content: |
    <PageTemplate bgurl="drugs.jpg">
        <BreadCrumb a="pf" b="drugs"><span>{{name}}</span></BreadCrumb>
        <CardStack>
            <Card>
                <CardContent>
                    <Typography type="headline">
                        {{name}}
                    </Typography>
                    <Typography type="subheading" color="secondary">
                        {{{description}}}
                    </Typography>
                </CardContent>
            </Card>
            <Card >
                <CardContent>
                    <Typography type="headline">
                        Genetic markers of {{lowercase name}} resistance
                    </Typography>
                    <Typography type="subheading" color="secondary">
                        Needs to be authored for {{lowercase name}}
                    </Typography>
                </CardContent>
            </Card>
            <Card>
                <CardContent>
                    <Typography type="headline">
                        Frequency of {{lowercase name}} resistance
                    </Typography>
                    <Typography type="subheading" color="secondary">

                    </Typography>
                    <Typography component="div">
                        The proportion of <em>P. falciparum</em> samples with <strong><em>MARKER_NAME</em></strong> markers of <strong>{{lowercase name}}</strong> resistance are:
                        <div style="padding-top: 20px">
                          {{#query 'region_id' 'name' table='pf_regions'}}
                            <ItemLink table="pf_regions" primKey="{{region_id}}">
                              <PercentMatching 
                                table="pf_samples" 
                                numQuery='{"whcClass":"compound","isCompound":true,"isRoot":true,"Components":[{"whcClass":"comparefixed","isCompound":false,"ColName":"region_id","CompValue":"{{region_id}}","Tpe":"="},{"whcClass":"comparefixed","isCompound":false,"ColName":"{{../drug_id}}resistant","CompValue":"yes","Tpe":"="}],"Tpe":"AND"}'
                                domQuery='{"whcClass":"compound","isCompound":true,"isRoot":true,"Components":[{"whcClass":"comparefixed","isCompound":false,"ColName":"region_id","CompValue":"{{region_id}}","Tpe":"="},{"whcClass":"compound","isCompound":true,"isRoot":true,"Components":[{"whcClass":"comparefixed","isCompound":false,"ColName":"{{../drug_id}}resistant","CompValue":"yes","Tpe":"="},{"whcClass":"comparefixed","isCompound":false,"ColName":"{{../drug_id}}resistant","CompValue":"no","Tpe":"="}],"Tpe":"OR"}],"Tpe":"AND"}'  
                              >
                                <ProportionBar 
                                  label="{{name}}" 
                                  colourTable="pf_samples" 
                                  colourProperty="{{../drug_id}}resistant" 
                                  numeratorPropertyValue="yes"
                                  remainderPropertyValue="no"
                                />
                              </PercentMatching>
                            </ItemLink>
                          {{/query}}
                        </div>
                    </Typography>
                </CardContent>
            </Card>
            <Card>
                <CardContent>
                    <Typography type="headline">
                        Exploring {{name}} resistance
                    </Typography>
                    <Typography type="subheading" color="secondary">

                    </Typography>
                    <Typography component="div">
                        <p>Here we can show some novel and innovative descriptions of <strong>{{lowercase name}}</strong> resistant parasites. For example:</p>
                        <ul>
                            <li><p>how many {{name}} parasites are also resistant for other drugs?</p></li>
                            <li><p>temporal change in {{name}} resistance</li></p>
                            <li><p>origins of {{name}} resistance</li></p>
                        </ul>
                    </Typography>
                </CardContent>
            </Card>
        </CardStack>
    </PageTemplate>
